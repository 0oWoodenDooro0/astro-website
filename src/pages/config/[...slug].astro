---
import { type CollectionEntry, getCollection, render } from 'astro:content';
import Layout from '../../layouts/Layout.astro';

export async function getStaticPaths() {
	const configs = await getCollection('config');
	return configs.map((config) => ({
		params: { slug: config.id },
		props: config,
	}));
}
type Props = CollectionEntry<'config'>;

const config = Astro.props;
const { Content } = await render(config);
---

<Layout title={`${config.data.title} | Config`}>
	<main class="container mx-auto px-4 py-12 max-w-5xl">
		<header class="mb-8 flex flex-col md:flex-row md:items-end justify-between gap-4">
			<div>
				<div class="flex items-center gap-4 mb-4">
					<a href="/config" class="text-ctp-pink hover:text-ctp-mauve transition-colors font-mono text-sm flex items-center gap-1">
						<svg xmlns="http://www.w3.org/2000/svg" width="16" height="16" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round"><path d="m15 18-6-6 6-6"/></svg>
						back
					</a>
				</div>
				<h1 class="text-4xl font-mono font-bold text-ctp-pink mb-2">{config.data.title}</h1>
				<p class="text-ctp-subtext1">{config.data.description || 'System configuration file'}</p>
			</div>
			<div class="flex items-center gap-2 text-[10px] font-mono font-bold uppercase tracking-wider text-ctp-overlay2 border border-ctp-surface1 px-3 py-1 rounded bg-ctp-mantle">
				<svg xmlns="http://www.w3.org/2000/svg" width="14" height="14" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round"><path d="m18 16 4-4-4-4"/><path d="m6 8-4 4 4 4"/><path d="m14.5 4-5 16"/></svg>
				{config.data.tech}
			</div>
		</header>
		
		<div class="border border-ctp-surface0 rounded-xl overflow-hidden bg-ctp-crust shadow-2xl">
			<div class="bg-ctp-mantle px-4 py-2 border-b border-ctp-surface0 flex items-center gap-2">
				<div class="flex gap-1.5">
					<div class="w-3 h-3 rounded-full bg-ctp-red/50"></div>
					<div class="w-3 h-3 rounded-full bg-ctp-yellow/50"></div>
					<div class="w-3 h-3 rounded-full bg-ctp-green/50"></div>
				</div>
				<span class="text-xs font-mono text-ctp-surface2 ml-2">{config.data.title}</span>
			</div>
			<div class="p-6 overflow-x-auto text-sm font-mono prose prose-ctp-mocha max-w-none">
				<Content />
			</div>
		</div>
	</main>
</Layout>

<style is:global>
	/* Basic styling for the rendered Markdown/Code */
	.prose pre {
		background-color: transparent !important;
		margin: 0 !important;
		padding: 0 !important;
	}
</style>
